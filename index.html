<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Grace to be Eve</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    margin:0;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:linear-gradient(180deg,#ffdee9 0%,#fff0f5 50%,#ffe6f0 100%);
    font-family:'Poppins',sans-serif;
  }

  /* Phone frame */
  .phone {
    width:420px; height:820px;
    background:#fff;
    border-radius:40px;
    box-shadow:0 0 40px rgba(255,150,180,.4);
    overflow:hidden;
    position:relative;
    display:flex;
    flex-direction:column;
  }

  /* Notch */
  .notch {
    position:absolute;
    top:0; left:50%;
    transform:translateX(-50%);
    width:180px; height:28px;
    background:#111;
    border-radius:0 0 20px 20px;
    z-index:10;
  }

  /* Status bar */
  .status-bar {
    height:28px; padding:0 14px;
    display:flex; justify-content:space-between; align-items:center;
    font-size:0.8em; font-weight:600; color:#cc3366;
  }
  .battery {
    width:24px; height:12px; border:2px solid #cc3366; border-radius:3px; position:relative;
  }
  .battery::after {
    content:""; position:absolute; right:-5px; top:2px;
    width:3px; height:6px; background:#cc3366; border-radius:1px;
  }
  .battery-level {height:100%; background:#cc3366;}

  /* App header */
  .app-header {
    font-size:1.3em; font-weight:600;
    text-align:center; color:#cc3366;
    padding:12px 0; border-bottom:1px solid #ffd6e6;
  }

  /* Screens */
  .screens {flex:1; display:flex; width:300%; transition:transform .5s;}
  .screen {width:100%; padding:20px; overflow-y:auto;}

  /* Choice cards */
  .choice {display:flex; flex-direction:column; gap:16px; margin-top:40px;}
  .card {
    background:#fff5f8;
    border-radius:16px; padding:20px;
    text-align:center; font-size:1.1em; color:#cc3366;
    font-weight:600; cursor:pointer;
    box-shadow:0 4px 10px rgba(255,150,180,.25);
    transition:.3s;
  }
  .card:hover {transform:translateY(-3px);}

  form {display:grid; gap:12px; margin-top:20px;}
  input,select,button {
    padding:12px; border-radius:10px;
    border:1px solid #ffd6e6; font-size:0.95em;
  }
  input:focus,select:focus {border-color:#ff80aa; outline:none;}
  button {
    background:linear-gradient(90deg,#ff99cc,#cc3366);
    color:#fff; font-weight:600; border:none; cursor:pointer;
  }

  /* Buyer list */
  .buyer-list {background:#fff; border-radius:12px; padding:12px; box-shadow:inset 0 0 6px #ffe6f0;}
  .buyer {padding:10px; border-bottom:1px solid #eee; font-size:0.9em;}
  .buyer strong {color:#cc3366; font-weight:600; display:block; margin-bottom:4px;}

  /* Rewards hearts */
  .progress {display:flex; gap:6px; margin-top:6px;}
  .heart {width:20px; height:20px; fill:none; stroke:#ff99bb; stroke-width:2;}
  .heart.filled {fill:#ff4d88; stroke:#ff4d88;}

  /* Nav bar */
  .nav {
    display:flex; justify-content:space-around;
    background:#fff0f5; border-top:1px solid #ffd6e6;
    padding:8px 0;
  }
  .nav button {
    background:none; border:none;
    flex:1; text-align:center;
    font-size:0.85em; font-weight:600;
    color:#cc3366; cursor:pointer;
    display:flex; flex-direction:column; align-items:center; gap:2px;
  }
  .nav button svg {width:20px; height:20px; fill:#cc3366;}
  .nav button.active {color:#ff4d88;}
  .nav button.active svg {fill:#ff4d88;}

  /* Popup */
  .popup {position:fixed; inset:0; background:rgba(0,0,0,.4); display:none; justify-content:center; align-items:center;}
  .popup-content {
    background:#fff; padding:20px; border-radius:16px;
    text-align:center; box-shadow:0 0 20px #ff99cc;
    font-size:1.1em; color:#cc3366;
  }

  /* Floating hearts */
  .love {position:absolute; font-size:1.4em; color:#ff3399;
    animation:floatUp 5s linear forwards; opacity:.8;}
  @keyframes floatUp {0%{opacity:1; transform:translateY(0);}100%{opacity:0; transform:translateY(-280px);} }
</style>
</head>
<body>

<div class="phone">
  <div class="notch"></div>
  <div class="status-bar">
    <div id="time">--:--</div>
    <div class="battery"><div class="battery-level" id="batteryLevel" style="width:100%"></div></div>
  </div>
  <div class="app-header" id="mainHeader">Grace to be Eve</div>

  <div class="screens" id="screens">
    <!-- Home -->
    <div class="screen">
      <div class="choice">
        <div class="card" onclick="showForm('new')">New Buyer</div>
        <div class="card" onclick="showForm('existing')">Existing Buyer</div>
      </div>

      <form id="newBuyerForm" style="display:none;">
        <input id="newName" placeholder="Full Name" required>
        <input id="newUsername" placeholder="Username" required>
        <input type="date" id="newDate" required>
        <input id="newProduct" placeholder="Purchased Product" required>
        <input id="newTotal" placeholder="Total Purchase (IDR)" required>
        <button type="submit">Submit</button>
      </form>

      <form id="existingBuyerForm" style="display:none;">
        <select id="existingUser" required></select>
        <input type="date" id="existDate" required>
        <input id="existProduct" placeholder="Purchased Product" required>
        <input id="existTotal" placeholder="Total Purchase (IDR)" required>
        <button type="submit">Add Purchase</button>
      </form>
    </div>

    <!-- Buyers -->
    <div class="screen"><div class="buyer-list" id="buyerList"></div></div>
    <!-- Rewards -->
    <div class="screen"><div class="buyer-list" id="rewardList"></div></div>
  </div>

  <!-- Nav -->
  <div class="nav">
    <button class="active" onclick="showScreen(0,'Grace to be Eve')">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3l9 8h-3v10h-12v-10h-3z"/></svg>
      Home
    </button>
    <button onclick="showScreen(1,'List of Buyers')">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 11c1.7 0 3-1.3 3-3s-1.3-3-3-3-3 1.3-3 3 1.3 3 3 3zm-8 0c1.7 0 3-1.3 3-3S9.7 5 8 5 5 6.3 5 8s1.3 3 3 3zm0 2c-2.3 0-7 1.2-7 3.5V20h14v-3.5C15 14.2 10.3 13 8 13zm8 0c-.3 0-.7 0-1 .1 1.2.9 2 2.1 2 3.4V20h6v-3.5c0-2.3-4.7-3.5-7-3.5z"/></svg>
      Buyers
    </button>
    <button onclick="showScreen(2,'Rewards')">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 6h-3.17c.11-.31.17-.65.17-1 0-1.66-1.34-3-3-3-1.01 0-1.9.5-2.45 1.26-.55-.76-1.44-1.26-2.45-1.26-1.66 0-3 1.34-3 3 0 .35.06.69.17 1H4c-1.1 0-2 .9-2 2v2h20v-2c0-1.1-.9-2-2-2zm-18 6v8c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-8H2z"/></svg>
      Rewards
    </button>
  </div>
</div>

<!-- Popup -->
<div class="popup" id="popup"><div class="popup-content"><p id="popupMsg"></p><button onclick="closePopup()">Close</button></div></div>

<script>
  let buyers=JSON.parse(localStorage.getItem("buyers"))||{};
  const formatIDR=new Intl.NumberFormat('id-ID',{style:'currency',currency:'IDR'});

  function updateClock(){document.getElementById('time').innerText=new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});}
  setInterval(updateClock,1000); updateClock();

  let battery=100; setInterval(()=>{battery=battery>0?battery-1:100;document.getElementById('batteryLevel').style.width=battery+'%';},60000);

  ["newTotal","existTotal"].forEach(id=>document.getElementById(id).addEventListener('input',e=>{
    let v=e.target.value.replace(/\D/g,''); e.target.value=v?formatIDR.format(v):"";
  }));

  function saveBuyers(){localStorage.setItem("buyers",JSON.stringify(buyers));renderBuyers();renderRewards();updateDropdown();}

  newBuyerForm.onsubmit=e=>{
    e.preventDefault();
    const name=newName.value,u=newUsername.value,d=newDate.value,p=newProduct.value,t=parseInt(newTotal.value.replace(/\D/g,''))||0;
    if(!buyers[u])buyers[u]={name,purchases:[]};
    buyers[u].purchases.push({date:d,product:p,total:t});
    saveBuyers(); spawnLove(); e.target.reset();
    if(buyers[u].purchases.length===6)showPopup(buyers[u].name);
  };

  existingBuyerForm.onsubmit=e=>{
    e.preventDefault();
    const u=existingUser.value,d=existDate.value,p=existProduct.value,t=parseInt(existTotal.value.replace(/\D/g,''))||0;
    buyers[u].purchases.push({date:d,product:p,total:t});
    saveBuyers(); spawnLove(); e.target.reset();
    if(buyers[u].purchases.length===6)showPopup(buyers[u].name);
  };

  function renderBuyers(){
    buyerList.innerHTML="";
    Object.keys(buyers).forEach(u=>{
      const b=buyers[u];
      buyerList.innerHTML+=`<div class="buyer"><strong>${b.name}</strong> (@${u})<br>${b.purchases.map(p=>`${p.date} - ${p.product} (${formatIDR.format(p.total)})`).join('<br>')}</div>`;
    });
  }

  function renderRewards(){
    rewardList.innerHTML="";
    Object.keys(buyers).forEach(u=>{
      const b=buyers[u];
      const hearts=[...Array(6)].map((_,i)=>`
        <svg class="heart ${i<b.purchases.length?'filled':''}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M12 21s-6.7-5.1-10-9.4C-1.1 7.2 2.4 2 7.5 2c2.3 0 4.1 1.3 4.5 3.1C12.4 3.3 14.2 2 16.5 2 21.6 2 25.1 7.2 22 11.6 18.7 15.9 12 21 12 21z"/>
        </svg>`).join('');
      rewardList.innerHTML+=`<div class="buyer"><strong>${b.name}</strong> (@${u})<br><div class="progress">${hearts}</div></div>`;
    });
  }

  function updateDropdown(){existingUser.innerHTML="";Object.keys(buyers).forEach(u=>{existingUser.innerHTML+=`<option value="${u}">${buyers[u].name} (@${u})</option>`;});}
  function showForm(t){newBuyerForm.style.display=t==="new"?"block":"none";existingBuyerForm.style.display=t==="existing"?"block":"none";}
  function showScreen(i,t){screens.style.transform=`translateX(-${i*100}%)`;document.querySelectorAll('.nav button').forEach((b,j)=>b.classList.toggle('active',j===i));mainHeader.innerText=t;if(i===1)renderBuyers();if(i===2)renderRewards();}
  function showPopup(n){popupMsg.innerText=`Congrats ${n}, you collected 6 stamps! ðŸŽ`;popup.style.display='flex';}
  function closePopup(){popup.style.display='none';}
  function spawnLove(){const l=document.createElement("div");l.className="love";l.innerText="â¤";l.style.left=Math.random()*350+"px";l.style.top="700px";document.querySelector(".phone").appendChild(l);setTimeout(()=>l.remove(),6000);}
  setInterval(spawnLove,3500);

  renderBuyers();renderRewards();updateDropdown();
</script>
</body>
</html>
